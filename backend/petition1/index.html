<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Collaborative Text Editor</title>
</head>
<body>
    <div>
        <textarea id="editor" cols="80" rows="20"></textarea>
    </div>

    <script>
        let socket;
    
        function connectWebSocket() {
            socket = new WebSocket("ws://localhost:3033/ws?document=firstPetition&Latitude=50&Longitude=80");
    
            socket.onopen = function () {
                console.log("WebSocket connection established.");
            };
    
            socket.onmessage = function (event) {
                console.log("Received message:", event.data);
                textArea.value = event.data;
            };
    
            socket.onerror = function (error) {
                console.error("WebSocket error:", error);
            };
    
            socket.onclose = function () {
                console.log("WebSocket connection closed. Reconnecting...");
                setTimeout(connectWebSocket, 200); // Attempt to reconnect after 2 seconds
            };
        }
    
        connectWebSocket();
    
        const textArea = document.getElementById("editor");
    
        textArea.addEventListener("input", function (event) {
            const text = event.target.value;
            console.log("About to send:", text);
            socket.send(text);
        });
    </script>

</body>
</html>
